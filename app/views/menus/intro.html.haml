!!! 5
%html{ lang: "en" }
  %head
    %title Introductory Videos - Shards of the Grid
    %meta{ charset: "UTF-8" }
    %meta{ name: "viewport", content: "width=device-width, initial-scale=1.0" }
    :css
      /* General page styling */
      html,
      body {
        background-color: #0d0e21; /* Dark background */
        color: white;
        margin: 0;
        height: 100%;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: Arial, sans-serif;
        overflow: hidden;
      }

      #video-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
        width: 100%;
      }

      video {
        width: 100%;
        height: 100%;
        max-height: 100vh; /* Maintain aspect ratio for fullscreen */
        object-fit: cover; /* Make sure videos cover the entire screen */
        border: none;
      }

  %body
    #video-container
      %video#intro-video-1{ controls: false, autoplay: true, muted: false }
        %source{ src: asset_path('intro1.mp4'), type: "video/mp4" }
        Your browser does not support the video tag.

      %video#intro-video-2{ controls: false, style: "display:none;" }
        %source{ src: asset_path('intro2.mp4'), type: "video/mp4" }
        Your browser does not support the video tag.

    :javascript
      // Play the second video after the first one ends
      document.addEventListener('DOMContentLoaded', function() {
        const introVideo1 = document.getElementById('intro-video-1');
        const introVideo2 = document.getElementById('intro-video-2');

        introVideo1.addEventListener('ended', function() {
          introVideo2.style.display = 'block';
          introVideo2.play();
        });

        // Render the welcome screen after the second video ends
        introVideo2.addEventListener('ended', function() {
          // Use an AJAX request to call the server and render the welcome screen
          fetch(window.location.href + '?welcome=true', {
            method: 'GET',
            headers: {
              'X-Requested-With': 'XMLHttpRequest'
            }
          })
          .then(response => response.text())
          .then(html => {
            document.body.innerHTML = html;
          })
          .catch(error => console.error('Error rendering welcome screen:', error));
        });
      });
